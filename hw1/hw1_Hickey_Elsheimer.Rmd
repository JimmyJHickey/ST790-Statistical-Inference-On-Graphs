---
title: "ST 790 Assignment 1"
output: pdf_document
urlcolor: blue

---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Instruction
This assignment consists of $4$ problems. The assignment is due on 
**Tuesday, September 1** at 11:59pm EDT. Please submit your assignment electronically through the **Moodle** webpage.
The assignment can be done as a group with at most 3 members per group (please include the name of the group members on the front page of the assignment).

# Problem 1
Download the political blogs dataset from [here](http://www-personal.umich.edu/~mejn/netdata/).
Now find the say, top ten, most "central" or "important" vertices via e.g., closeness centrality, betweeness centrality, Katz centrality, page-rank centrality, and hubs/authority centrality. Does the blogs that you identified similar to that in Table 1 through Table 3 of 
[Adamic and Glance](http://www.ramb.ethz.ch/CDstore/www2005-ws/workshop/wf10/AdamicGlanceBlogWWW.pdf) ? 

# Problem 2
Skim through this [article](https://arxiv.org/pdf/0706.1062.pdf) by Clauset, Shalizi, and Newman. Now download the yeast metabolic network dataset from [here](http://tuvalu.santafe.edu/~aaronc/powerlaws/data.htm). Fit a power-law to the degree distribution for this dataset. Do you think the degree distribution for this network follows a power-law ?

# Problem 3
Let $X_1, X_2, \dots, X_n$ be i.i.d random variables. The sample variance of the $X_i$ can be written as a $U$-statistics, i.e.,
$$s^2 = \frac{2}{n(n-1)} \sum_{i < j} \frac{1}{2} (X_i - X_j)^2.$$
Suppose now the $X_i$ are i.i.d Bernoulli random variables with probability of success $p \in (0,1)$. Derive a non-degenerate limiting distribution for $s^2$. What happens to this limiting distribution when $p = 1/2$ ?

# Problem 4
We now consider the problem of goodness-of-fit test for Erdos-Renyi graphs. More specifically, let $\mathcal{G} = \mathcal{G}(n,m,p, q)$ be a random graph model defined as follows. A graph $G$ is an instance of $\mathcal{G}$ if $G$ is an undirected graph on $n$ vertices with adjacency matrix $\mathbf{A} = (a_{ij})$ of the form
\begin{gather*}
a_{ij} \sim \mathrm{Bernoulli}(q), \quad \text{if $i \in \mathcal{S}$ and $j \in \mathcal{S}$} \\
a_{ij} \sim \mathrm{Bernoulli}(p), \quad \text{otherwise}.
\end{gather*}
Here $\mathcal{S} \subset \{1,2,\dots,n\}$ is a subset of vertices with $|\mathcal{S}| = m$ and we have assumed that $q > p \in (0,1)$. 
Note that $m = 0$ corresponds to the normal Erdos-Renyi graph and $m > 0$ corresponds to a random graph model where there is a subset $\mathcal{S}$ of $m$ vertices with larger communication probability $q$ among themselves.

Given a graph $G \sim \mathcal{G}(n,m,p,q)$, we are interested in testing the null hypothesis 
$\mathbb{H}_0 \colon |\mathcal{S}| = m = 0$ against the alternative hypothesis that $\mathbb{H}_A \colon |\mathcal{S}| = m > 0$. 

For this problem, we will use two test statistics. The first test statistic is $\Delta$, the maximum degree and the second test statistic is $\tau$, the number of triangles. More specifically, given a graph $G \sim \mathcal{G}(n,m,p,q)$, and suppose we are using $\Delta$ as the test statistic. Then we will reject the null hypothesis if $\Delta$ exceeds some threshold $c$. 

Perform a simulation study to determine the power of the test procedures when we use (1) $\Delta$ as the test statistic and (2) when we use $\tau$ as the test statistic. To reduce computation time, set $n = 1000$, $p = 0.4$, and $q = 0.6$ and let $m \in \{10,25,50,100\}$. Report a table for the power of the test statistics as a function of $m$.

**Hint** To generate a graph from the $\mathcal{G}(n,m,p,q)$ when $m > 0$, you can use the following igraph chunk.

```{r, message = FALSE}
library(igraph)
p <- 0.4
q <- 0.6
n <- 1000
m <- 10
B <- matrix(c(p,p,p,q),nrow = 2)
A <- sbm.game(n = n, pref.matrix = B, block.sizes = c(n-m,m))
A
```

The maximum degree and the number of triangles can be easily determined via
```{r}
max(degree(A))
sum(count_triangles(A))/3
```



